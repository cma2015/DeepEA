<tool id="logoplot" name="Sequence Visualization"  version='18.09'>
  <description>Weblogo or twosamplelogo</description>
  <command><![CDATA[
	Rscript $__tool_directory__/motif_plot.R $posseq $negseq $method.type $plottype.type $Figure_logo $__tool_directory__;
  ]]></command>
  <inputs>
	<param name="posseq" type="data" format="fasta" label="The plot sequence"  help="Need to be aligned and equal length"/>
	<param name="negseq" type="data" format="fasta" value="NULL" label="The background sequence" />
	<conditional name="method">
		<param name="type" type="select" label="Analysis method" >
			<option value="seqlogo" selected="true">Single sample</option>
			<option value="twosamplelogo" >Two samples (need input the background/negative sequence)</option>
		</param>
	</conditional>
	<conditional name="plottype">
		<param name="type" type="select" label="Visualization type" >
			<option value="weblogo" selected="true">Logo plot base on weblogo</option>
			<option value="barlogo"  >Logo plot base on barlogo</option>
		</param>
	</conditional>

	
  </inputs>
  <stdio>
	<exit_code range="1:"  level="fatal" description="Error Running combine collection to a file" />
  </stdio>
  <outputs> 
	<data name="Figure_logo" format="pdf" label="${tool.name} on ${on_string}: Figure_logo.pdf">
	</data>
  </outputs>
  <help><![CDATA[
.. class:: infomark

**What it does**

**Sequence Visualization** : Statistical sequence composition, and sequence composition display of single or two groups of sequences

-----

.. class:: infomark

**Inputs**

- **The plot sequence:** Visualization sequence to be analyzed

- **The background sequence:** Input sequence when performing two sets of sequence difference composition analysis.

-----

.. class:: infomark

**Parameters**

- **Single sample**: Perform a one-sample analysis where the background sequence is ignored

- **Two samples**: Analysis of two sets of sequence differences and visualization

- **Visualization type**: Visualization method


.. class:: infomark

**Outputs**


* **Motiflogo**

  .. image:: static/plot/5weblogo.png
      :width: 500 px
      :scale: 100 %   
      :align: center

---------------------

* **Barlogo**

  .. image:: static/plot/5barlogo.png
      :width: 500 px
      :scale: 100 %   
      :align: center
    
    
---------------------    

* **Two sample logo**
    

  .. image:: static/plot/5tsl.png
      :width: 500 px
      :scale: 100 %   
      :align: center    


]]></help>
</tool>


