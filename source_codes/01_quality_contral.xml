<tool id="Quality_control" name="Quality Control" version="0.11.7">
	<description></description>
	<command><![CDATA[
        #import re
        #set input_name = re.sub('[^\w\-\s]', '_', str($input_file.element_identifier))
        
        #if $input_file.ext.endswith('.gz'):
            #set input_file_sl = $input_name + '.gz'
        #elif $input_file.ext.endswith('.bz2'):
            #set input_file_sl = $input_name + '.bz2'
        #else
            #set input_file_sl = $input_name
        #end if

        #if 'bam' in $input_file.ext:
            #set format = 'bam'
        #elif 'sam' in $input_file.ext:
            #set format = 'sam'
        #else
            #set format = 'fastq'
        #end if

        ln -s '${input_file}' '${input_file_sl}' &&
        mkdir -p '${html_file.files_path}' &&
        fastqc
            --outdir '${html_file.files_path}'
            
            --quiet
            --extract
            -f '${format}'
            '${input_file_sl}'

        && cp '${html_file.files_path}'/*/fastqc_data.txt output.txt
        && cp '${html_file.files_path}'/*\.html output.html

    ]]></command>
	<inputs>
        <param format="fastq,fastq.gz,fastq.bz2,bam,sam" name="input_file" type="data"
               label="Short read data from your current history" />
    </inputs>
    <outputs>
        <data format="html" name="html_file" from_work_dir="output.html" label="${tool.name} on ${on_string}: Webpage" />
        <data format="txt" name="text_file"  from_work_dir="output.txt" label="${tool.name} on ${on_string}: RawData" />
    </outputs>
          	<help>
.. class:: infomark

**What it does**

FastQC aims to provide a simple way to do some quality control checks on raw sequence data coming from high throughput sequencing pipelines. It provides a modular set of analyses which you can use to give a quick impression of whether your data has any problems of which you should be aware before doing any further analysis.

The main functions of FastQC are:

* Import of data from BAM, SAM or FastQ/FastQ.gz files (any variant),
* Providing a quick overview to tell you in which areas there may be problems
* Summary graphs and tables to quickly assess your data
* Export of results to an HTML based permanent report
* Offline operation to allow automated generation of reports without running the interactive application


.. class:: infomark

**Inputs**

* Raw RNA-Seq data. `RNA-Seq demo`_

.. _RNA-Seq demo: https://github.com/cma2015/CAFU/tree/master/test_data/SE%20RNA-Seq

.. class:: infomark

**Outputs**

The tool produces a basic text and a HTML output file that contain all of the results, including the following:

* Basic Statistics
* Per base sequence quality
* Per sequence quality scores
* Per base sequence content
* Per base GC content
* Per sequence GC content
* Per base N content
* Sequence Length Distribution
* Sequence Duplication Levels
* Overrepresented sequences
* Kmer Content


.. class:: infomark

**Citation**

* Andrews S. FastQC: a quality control tool for high throughput sequence data 2010.

    </help>
</tool>

