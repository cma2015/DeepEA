<tool id="De_novo_discovery motifs" name="De-novo Motifs Discovery "  version='18.09'>
  <description>Searches motifs and Visualization</description>
  <command><![CDATA[
	Rscript $__tool_directory__/motif.R $input_seq $genome $method.motif_method $motif_number $motif_length $plot.plot_motif $motif $Figure_motif  $__tool_directory__ ;
  ]]></command>
  <inputs>
	<param name="input_seq" type="data" format="fasta" label="Peaks sequences / CMRs related sequences" />
	<param name="genome" type="data" format="fasta" label="Background sequences" />
	<conditional name="method">
		<param name="motif_method" type="select" label="Motifs discovery method" >
			<option value="motifRG" selected="true"> "motifRG" method (Regression methods)</option>
			<option value="GADEM" >"GADEM" method (Bayes methods) </option>
		</param>
	</conditional>
	<param name="motif_number" type="text" value="3"
		label="Motif number" >
	</param>
	<param name="motif_length" type="text" value="5"
		label="Motif search length">
	</param>
	<conditional name="plot">
		<param name="plot_motif" type="select" label="Output the motif logo ?" >
			<option value="TRUE" >TRUE</option>
			<option value="FALSE" selected="true" >FALSE </option>
		</param>
	</conditional>

	
  </inputs>
  <stdio>
	<exit_code range="1:"  level="fatal" description="Error Running combine collection to a file" />
  </stdio>
  <outputs> 
	<data name="motif" format="tsv" label="${tool.name} on ${on_string}: Motif logo words.txt">
	</data>
	<data name="Figure_motif" format="pdf" label="${tool.name} on ${on_string}: Figure_motif_logo.pdf">
	<filter>plot['plot_motif'] == "TRUE"</filter>
	</data>
  </outputs>
 <help>

.. class:: infomark

**What it does**

Perform de novo motif discovery to evaluate enriched motifs using "motifRG" and "GADEM" methods and plot weblogo images for motifs.

-------------

.. class:: infomark

**Inputs**

- **Peaks sequences / CMRs related sequence** - Use peaks sequences or CMRs flanking sequences (**fasta** format).

- **Background sequences** - Reference genome/transcriptome sequences or randomly sequences as the background (**fasta** format).

- **Motifs discovery method** - For the specific method of motif discovery, we offer two different methods to choose.

	* **motifRG**- Tools for discriminative motif discovery using regression methods.

	* **GADEM** - The de novo motif discovery is performed through genetic algorithm in 'rGADEM' package.

-------------

.. class:: infomark

**Outputs**
Output motif annotaion files and discovered motif weblogo images.

**Motifs** (**tsv** format):

====== ========== =================================
Column Name       Description
====== ========== =================================
     1 motif	  motif words
     2 scores     motif score
====== ========== =================================

------------

**Weblogo images** (**pdf** format):

.. image:: static/plot/motif.png
    :width: 500 px
    :scale: 100 %   
    :align: center

| 



  </help>

</tool>


